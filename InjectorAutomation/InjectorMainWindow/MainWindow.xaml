<controls:MetroWindow
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Mychart="clr-namespace:AutoChart;assembly=AutoChart"
    xmlns:changes="clr-namespace:InjectorMainWindow.ValueChanged"
    xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:extra="http://metro.mahapps.com/winfx/xaml/extra"
    xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
    xmlns:list="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:InjectorMainWindow"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:system="clr-namespace:System;assembly=mscorlib"
    Name="main"
    Title="折叠屏软件"
    Width="800"
    Height="600"
    list:Class="InjectorMainWindow.MainWindow"
    KeyUp="MoveKey"
    mc:Ignorable="d">
    <controls:MetroWindow.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Colors.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/Blue.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/BaseLight.xaml" />
                <ResourceDictionary Source="Resources/Icons.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <Style list:Key="DescriptionHeaderStyle" TargetType="Label">
                <Setter Property="FontSize" Value="22" />
                <Setter Property="HorizontalAlignment" Value="Center" />
            </Style>

            <Style BasedOn="{StaticResource MetroValidationPopup}" TargetType="{x:Type controls:CustomValidationPopup}">
                <Setter Property="CloseOnMouseLeftButtonDown" Value="False" />
            </Style>
            <!--  datagrid样式  -->
            <Style list:Key="DataGridStyle" TargetType="{x:Type DataGrid}">
                <Setter Property="HorizontalAlignment" Value="Stretch" />
            </Style>
            <!--  quick change of the collapse storyboard duration  -->
            <Storyboard list:Key="MetroExpanderCollapseStoryboard">
                <DoubleAnimation
                    Storyboard.TargetName="ExpandSite"
                    Storyboard.TargetProperty="(UIElement.Opacity)"
                    To="0"
                    Duration="0:0:0.1" />
                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ExpandSite" Storyboard.TargetProperty="(UIElement.Visibility)">
                    <DiscreteObjectKeyFrame KeyTime="0:0:0.1" Value="{x:Static Visibility.Collapsed}" />
                </ObjectAnimationUsingKeyFrames>
            </Storyboard>

            <Style list:Key="menuitem" TargetType="StackPanel">
                <Setter Property="Background" Value="#ededed" />
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="true">
                        <Setter Property="Background" Value="Gray" />
                        <Setter Property="Cursor" Value="Hand" />
                    </Trigger>
                </Style.Triggers>
            </Style>
            <system:Int32 list:Key="row">13</system:Int32>
            <system:Int32 list:Key="col">8</system:Int32>

            <Style list:Key="uniformgridtemp" TargetType="ListBox">
                <Style.Setters>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate>
                                <UniformGrid
                                    Columns="{DynamicResource col}"
                                    IsItemsHost="True"
                                    Rows="{DynamicResource row}" />
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style.Setters>
            </Style>

        </ResourceDictionary>
    </controls:MetroWindow.Resources>
    <Canvas Name="mainLayout" Background="#ededed">
        <Grid
            Width="744"
            Height="{Binding ElementName=mainLayout, Path=ActualHeight}" Canvas.Left="50">
            <Grid.RowDefinitions>
                <RowDefinition Height="30" />
                <RowDefinition Height="403*" />
                <RowDefinition Height="138*"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="50" />
                <ColumnDefinition Width="73*" />
                <ColumnDefinition Width="637*"/>
            </Grid.ColumnDefinitions>

            <Grid Grid.ColumnSpan="3" Margin="0,0,0,0.4">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <StackPanel Orientation="Horizontal">
                    <StackPanel
                        Margin="5,1,1,1"
                        MouseDown="Link"
                        Orientation="Horizontal"
                        Style="{StaticResource menuitem}">
                        <Image Margin="5" Source="Resources/link.png" />
                        <TextBlock
                            Margin="5"
                            VerticalAlignment="Center"
                            Text="连接" />
                    </StackPanel>
                    <StackPanel
                        Margin="5,1,1,1"
                        MouseDown="DisLink"
                        Orientation="Horizontal"
                        Style="{StaticResource menuitem}">
                        <Image Margin="5" Source="Resources/dislink.png" />
                        <TextBlock
                            Margin="5"
                            VerticalAlignment="Center"
                            Text="断开连接" />
                    </StackPanel>
                </StackPanel>

                <Border
                    Grid.Column="1"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    MouseUp="ToolBarDoubelClick">
                    <TextBlock Name="version" Text="" />
                </Border>
            </Grid>


            <controls:MetroAnimatedSingleRowTabControl
                Name="pages"
                Grid.ColumnSpan="3"
                Margin="0,30,0,0.4" Grid.RowSpan="3" SelectionChanged="pages_SelectionChanged">
                <controls:MetroAnimatedSingleRowTabControl.ItemContainerStyle>
                    <Style>
                        <Setter Property="TabItem.Visibility" Value="Collapsed" />
                    </Style>
                </controls:MetroAnimatedSingleRowTabControl.ItemContainerStyle>
                <TabItem Header="图表">
                    <StackPanel>
                        <GroupBox Header="折叠屏控制">
                            <StackPanel>
                                <DockPanel VerticalAlignment="Center" Margin="10">
                                    <Label DockPanel.Dock="Left" FontSize="20" Margin="10">A屏</Label>
                                    <TextBlock Margin="10" FontSize="20" HorizontalAlignment="Right" Text="{Binding ElementName=angleA, Path=Value}" DockPanel.Dock="Right"/>
                                    <Slider
                                        list:Name="angleA"
                                        AutoToolTipPlacement="TopLeft"
                                        AutoToolTipPrecision="0"
                                        IsSnapToTickEnabled="True"
                                        Maximum="360"
                                        Minimum="0"
                                        SmallChange="90"
                                        TickFrequency="90"
                                        TickPlacement="BottomRight"/>
                                </DockPanel>
                                <DockPanel VerticalAlignment="Center" Margin="10">
                                    <Label DockPanel.Dock="Left" FontSize="20" Margin="10">B屏</Label>
                                    <TextBlock Margin="10" FontSize="20" HorizontalAlignment="Right" Text="{Binding ElementName=angleB, Path=Value}" DockPanel.Dock="Right"/>
                                    <Slider
                                     list:Name="angleB"
                                        AutoToolTipPlacement="TopLeft"
                                        AutoToolTipPrecision="0"
                                        IsSnapToTickEnabled="True"
                                        Maximum="270"
                                        Minimum="0"
                                        SmallChange="90"
                                        TickFrequency="90"
                                        TickPlacement="BottomRight" />
                                </DockPanel>

                                <StackPanel Orientation="Horizontal">
                                    <Button 
                                        Width="100"
                                        Margin="5"
                                        list:Name="buttonReset"
                                        Click="ButtonReset_Click"
                                        DockPanel.Dock="Right">
                                        复位
                                    </Button>
                                    <Button 
                                        Width="100"
                                        Margin="5"
                                        list:Name="buttonMove"
                                        Click="ButtonMove_Click"
                                        DockPanel.Dock="Right">

                                        移动
                                    </Button>
                                    <Button 
                                        Width="100"
                                        Margin="5"
                                        list:Name="buttonRead"
                                        Click="ButtonRead_Click"
                                        DockPanel.Dock="Right">
                                        读取位置
                                    </Button>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>

                        <StackPanel Orientation="Horizontal"  Margin="0,40">
                            <ListBox Name="comsBox">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="70" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock
                                                Grid.Column="0"
                                                VerticalAlignment="Center"
                                                Text="{Binding Key, Mode=TwoWay}" />
                                            <Border
                                                Grid.Column="1"
                                                Width="130"
                                                Margin="1"
                                                BorderBrush="Black"
                                                BorderThickness="0,1,0,2"
                                                CornerRadius="4">
                                                <ComboBox
                                                  
                                                    Width="130"
                                                    HorizontalContentAlignment="Center"
                                                    VerticalContentAlignment="Center"
                                                    Background="{x:Null}"
                                                    BorderThickness="0"
                                                    Foreground="#444444"
                                                    ItemsSource="{Binding ElementName=main, Path=ExitComs}"
                                                    SelectedItem="{Binding Path=Value, Mode=TwoWay}" />
                                            </Border>
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>

                            <Button
                                Height="40"
                                Margin="5,0,0,0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Top"
                                Click="RefreshComs">
                                <Button.Content>
                                    <Image Source="Resources/refresh.png" />
                                </Button.Content>
                            </Button>

                            <TextBlock
                                Margin="40,0,0,0"
                                VerticalAlignment="Top"
                                Text="服务器:" />
                            <TextBox
                                Name="ipbox"
                                Width="100"
                                Margin="5,0,0,0"
                                VerticalAlignment="Top"
                                VerticalContentAlignment="Center"
                                controls:TextBoxHelper.AutoWatermark="True"
                                controls:TextBoxHelper.UseFloatingWatermark="True"
                                controls:TextBoxHelper.Watermark="服务IP"
                                controls:TextBoxHelper.WatermarkAlignment="Center"
                                BorderThickness="0"
                                FontSize="18"
                                Text="127.0.0.1" />
                            <TextBox
                                Name="portbox"
                                Width="100"
                                Margin="5,0,0,0"
                                VerticalAlignment="Top"
                                VerticalContentAlignment="Center"
                                controls:TextBoxHelper.AutoWatermark="True"
                                controls:TextBoxHelper.UseFloatingWatermark="True"
                                controls:TextBoxHelper.Watermark="端口"
                                controls:TextBoxHelper.WatermarkAlignment="Center"
                                BorderThickness="0"
                                FontSize="18"
                                Text="8787" />
                        </StackPanel>
                    </StackPanel>

                </TabItem>
                <TabItem Header="日志">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="30" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock VerticalAlignment="Center" Text="一般日志" />
                            <controls:ToggleSwitchButton IsChecked="{Binding ElementName=main, Path=IsNormalLog, Mode=TwoWay}" />
                            <TextBlock
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="警告日志" />
                            <controls:ToggleSwitchButton IsChecked="{Binding ElementName=main, Path=IsWaringLog, Mode=TwoWay}" />
                            <TextBlock
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="错误日志" />
                            <controls:ToggleSwitchButton IsChecked="{Binding ElementName=main, Path=IsErrorLog, Mode=TwoWay}" />
                        </StackPanel>
                        <RichTextBox
                            Grid.Row="1"
                            IsReadOnly="True"
                            ScrollViewer.CanContentScroll="True"
                            ScrollViewer.PanningMode="VerticalOnly"
                            ScrollViewer.PanningRatio="10"
                            VerticalScrollBarVisibility="Visible">
                            <RichTextBox.Background>
                                <ImageBrush ImageSource="Resources/log.jpg" Opacity="0.2" />
                            </RichTextBox.Background>
                            <FlowDocument>
                                <Paragraph Name="logBox">
                                    <!--<Run Name="LogText" Text="" />
                                <Run Text="" />-->
                                </Paragraph>
                            </FlowDocument>
                        </RichTextBox>
                    </Grid>
                </TabItem>

                <TabItem Header="接口测试">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="30" />
                            <RowDefinition />
                            <RowDefinition Height="30" />
                        </Grid.RowDefinitions>

                        <TextBlock Grid.ColumnSpan="2" Text="接口测试" />
                        <ListBox Name="interfaceList" Grid.Row="1">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <RadioButton VerticalAlignment="Center" Content="{Binding Describe}">
                                            <RadioButton.IsChecked>
                                                <Binding
                                                    Mode="TwoWay"
                                                    Path="IsSelected"
                                                    RelativeSource="{RelativeSource AncestorType=ListBoxItem}" />
                                            </RadioButton.IsChecked>
                                        </RadioButton>
                                        <TextBlock VerticalAlignment="Center" Text="{Binding InterfaceName}" />
                                    </StackPanel>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                        <StackPanel Grid.Row="1" Grid.Column="1">
                            <ListBox ItemsSource="{Binding ElementName=interfaceList, Path=SelectedItem.Paramters}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="70" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock VerticalAlignment="Center" Text="{Binding Path=Name}" />
                                            <TextBox
                                                Grid.Column="1"
                                                Width="240"
                                                VerticalAlignment="Center"
                                                Text="{Binding Path=Value, Mode=TwoWay}" />
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            <Button
                                controls:ButtonHelper.CornerRadius="5"
                                Click="DoInterfaceClick"
                                Content="执行接口" />
                            <TextBlock Text="接口返回的结果:" />
                            <TextBox
                                Name="resultBox"
                                Height="200"
                                IsReadOnly="True"
                                TextWrapping="Wrap" />
                        </StackPanel>
                    </Grid>
                </TabItem>
                <TabItem Header="配置">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="60" />
                            <RowDefinition Height="150" />
                            <RowDefinition Height="30" />
                            <RowDefinition />
                        </Grid.RowDefinitions>

                        <StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Name="positioninfo"
                                    Margin="5"
                                    Text="无连接" />
                            </StackPanel>

                            <StackPanel Margin="1" Orientation="Horizontal">
                                <Button
                                    Height="30"
                                    Background="{x:Null}"
                                    Click="LoadConfig">
                                    <Button.Content>
                                        <StackPanel Width="60" Orientation="Horizontal">
                                            <Image Source="Resources/load.png" />
                                            <TextBlock
                                                VerticalAlignment="Center"
                                                FontSize="16"
                                                FontWeight="Bold"
                                                Text="导入" />
                                        </StackPanel>
                                    </Button.Content>
                                </Button>
                                <Button
                                    Height="30"
                                    Margin="1"
                                    Background="{x:Null}"
                                    Click="UpLoadConfig">
                                    <Button.Content>
                                        <StackPanel Width="60" Orientation="Horizontal">
                                            <Image Source="Resources/load.png" />
                                            <TextBlock
                                                VerticalAlignment="Center"
                                                FontSize="16"
                                                FontWeight="Bold"
                                                Text="导出" />
                                        </StackPanel>
                                    </Button.Content>
                                </Button>
                            </StackPanel>
                        </StackPanel>


                        <StackPanel Grid.Row="2" Orientation="Horizontal">
                            <TextBlock VerticalAlignment="Center" Text="步长" />
                            <controls:NumericUpDown
                                Name="stepNum"
                                MinWidth="100"
                                VerticalAlignment="Center"
                                Value="10" />
                        </StackPanel>
                        <StackPanel Grid.Row="3" Margin="10">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="60" />
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="1" Orientation="Vertical">
                                    <Button
                                        Height="30"
                                        HorizontalAlignment="Center"
                                        Click="AddPhoneItemClick">
                                        <Button.Content>
                                            <Image Source="Resources/add.png" />
                                        </Button.Content>
                                    </Button>
                                    <Button
                                        Height="30"
                                        Margin="5"
                                        HorizontalAlignment="Center">
                                        <Button.Content>
                                            <Image Source="Resources/remove.png" />
                                        </Button.Content>
                                    </Button>
                                </StackPanel>
                            </Grid>

                        </StackPanel>
                    </Grid>
                </TabItem>
            </controls:MetroAnimatedSingleRowTabControl>
        </Grid>
        <controls:HamburgerMenu
            Name="leftMenus"
            Height="570"
            MinWidth="40"
            BorderBrush="Black"
            BorderThickness="1"
            ItemClick="LeftMenuClick">
            <controls:HamburgerMenu.Content>
                <StackPanel />
            </controls:HamburgerMenu.Content>
            <controls:HamburgerMenu.ItemTemplate>
                <DataTemplate>
                    <StackPanel Margin="5,3,3,3" Orientation="Horizontal">
                        <Image Height="40" Source="{Binding Icon}">
                            <Image.ToolTip>
                                <TextBlock
                                    Margin="5"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Background="{x:Null}"
                                    Text="{Binding MenuName}" />
                            </Image.ToolTip>
                        </Image>
                        <TextBlock
                            Margin="5"
                            VerticalAlignment="Center"
                            Text="{Binding MenuName}" />
                    </StackPanel>
                </DataTemplate>
            </controls:HamburgerMenu.ItemTemplate>
        </controls:HamburgerMenu>
    </Canvas>
</controls:MetroWindow>

